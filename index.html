<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>FeedFlow 2.0 - Generador IA</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Estilos -->
  <link rel="stylesheet" href="styles.css">
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js"></script>
</head>
<body>

  <div class="container">
    <h1>FeedFlow 2.0 - Generador de Ideas IA</h1>

    <div id="login-container">
      <button id="loginBtn">Iniciar sesión con GitHub</button>
    </div>

    <div id="language-selector" style="display:none;">
      <label>Idioma:</label>
      <select id="language">
        <option value="es">Español</option>
        <option value="en">English</option>
        <option value="pt">Português</option>
      </select>
    </div>

    <div id="generator-form" style="display:none;">
      <h2>Modo de generación:</h2>
      <label><input type="radio" name="mode" value="multi" checked> Multi-redes</label>
      <label><input type="radio" name="mode" value="single"> Una red (3 ideas)</label>

      <h2>Ideas para:</h2>
      <div id="networks">
        <label><input type="checkbox" name="network" value="Facebook"> Facebook</label>
        <label><input type="checkbox" name="network" value="Instagram"> Instagram</label>
        <label><input type="checkbox" name="network" value="LinkedIn"> LinkedIn</label>
        <label><input type="checkbox" name="network" value="X"> X (antes Twitter)</label>
        <label><input type="checkbox" name="network" value="TikTok"> TikTok</label>
        <label><input type="checkbox" name="network" value="WhatsApp"> WhatsApp</label>
        <label><input type="checkbox" name="network" value="YouTube"> YouTube</label>
      </div>

      <h2>Idea o palabra clave:</h2>
      <input type="text" id="keyword">

      <h2>¿Qué efecto quieres generar?</h2>
      <select id="effect">
        <option value="">Selecciona...</option>
        <option value="Motivación">Motivación</option>
        <option value="Credibilidad/Autoridad">Credibilidad/Autoridad</option>
        <option value="Curiosidad">Curiosidad</option>
        <option value="Urgencia o escasez">Urgencia o escasez</option>
      </select>
      <p id="effect-desc"></p>

      <h2>Tipo de copy:</h2>
      <select id="copyType">
        <option value="">Selecciona...</option>
        <option value="Llamada a la acción (CTA)">Llamada a la acción (CTA)</option>
        <option value="Testimonio o prueba social">Testimonio o prueba social</option>
        <option value="Informativo o educativo">Informativo o educativo</option>
        <option value="Técnico o profesional">Técnico o profesional</option>
      </select>
      <p id="copy-desc"></p>

      <button id="generateBtn">Generar Ideas</button>
    </div>

    <div id="results" style="display:none;">
      <h2>Resultados:</h2>
      <div id="output"></div>
    </div>

  </div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
  import { getAuth, signInWithPopup, GithubAuthProvider, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-auth.js";

const firebaseConfig = {
  apiKey: "AIzaSyCScJA-UGs3WcBnfAm-6K94ybZ4bzBahz8",
  authDomain: "brain-storm-8f0d8.firebaseapp.com",
  databaseURL: "https://brain-storm-8f0d8-default-rtdb.firebaseio.com",
  projectId: "brain-storm-8f0d8",
  storageBucket: "brain-storm-8f0d8.appspot.com",
  messagingSenderId: "401208607043",
  appId: "1:401208607043:web:6f35fc81fdce7b3fbeaff6"
};

  const app = initializeApp(firebaseConfig);
  const auth = getAuth();

  document.getElementById('loginBtn').addEventListener('click', () => {
    const provider = new GithubAuthProvider();
    signInWithPopup(auth, provider)
      .catch(e => alert("Error al iniciar sesión: " + e));
  });

  onAuthStateChanged(auth, (user) => {
    if (user) {
      document.getElementById('login-container').style.display = 'none';
      document.getElementById('language-selector').style.display = 'block';
      document.getElementById('generator-form').style.display = 'block';
    }
  });

  // Descripciones dinámicas:
  const effects = {
    "Motivación": "Generar entusiasmo, energía positiva y deseo de actuar.",
    "Credibilidad/Autoridad": "Transmitir experiencia, conocimientos sólidos y respaldo profesional.",
    "Curiosidad": "Despertar el interés, la intriga o el deseo de saber más.",
    "Urgencia o escasez": "Motivar a actuar rápido por tiempo limitado o recursos escasos."
  };

  const copyTypes = {
    "Llamada a la acción (CTA)": "Invita directamente a realizar una acción inmediata.",
    "Testimonio o prueba social": "Muestra validación social con opiniones o casos de éxito.",
    "Informativo o educativo": "Aporta conocimiento útil, consejos o formación.",
    "Técnico o profesional": "Contenido especializado, para públicos expertos."
  };

  document.getElementById('effect').addEventListener('change', e => {
    document.getElementById('effect-desc').innerText = effects[e.target.value] || '';
  });

  document.getElementById('copyType').addEventListener('change', e => {
    document.getElementById('copy-desc').innerText = copyTypes[e.target.value] || '';
  });

  document.getElementById('generateBtn').addEventListener('click', async () => {
    const keyword = document.getElementById('keyword').value.trim();
    const effect = document.getElementById('effect').value;
    const copyType = document.getElementById('copyType').value;
    const networks = Array.from(document.querySelectorAll("input[name='network']:checked")).map(el => el.value);
    const mode = document.querySelector("input[name='mode']:checked").value;

    if (!keyword || !effect || !copyType || networks.length === 0) {
      alert("Por favor completa todos los campos.");
      return;
    }

    try {
      const response = await fetch("https://us-central1-brain-storm-8f0d8.cloudfunctions.net/api/generateIdeas", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ keyword, desiredEffect: effect, copyType, networks, mode })
      });
      const data = await response.json();
      document.getElementById('results').style.display = 'block';
      document.getElementById('output').innerText = JSON.stringify(data, null, 2);
    } catch (error) {
      alert("Error al generar ideas.");
    }
  });
</script>

</body>
</html>
